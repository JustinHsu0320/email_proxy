# .docker/.env.prod.example
# 郵件代理系統生產環境變數範例

# ============================================
# Environment
# ============================================
APP_ENV=production

# ============================================
# Proxy 設定（生產環境必填）
# ============================================
HTTP_PROXY=http://proxy.ptc-nec.com.tw:3128
HTTPS_PROXY=http://proxy.ptc-nec.com.tw:3128
NO_PROXY=localhost,127.0.0.1,postgresql,keydb,rabbitmq

# ============================================
# PostgreSQL
# ============================================
POSTGRES_USER=smtp_user
POSTGRES_PASSWORD=your_secure_password
POSTGRES_DB=smtp_service

# ============================================
# RabbitMQ
# ============================================
RABBITMQ_USER=admin
RABBITMQ_PASSWORD=your_secure_password

# ============================================
# KeyDB
# ============================================
KEYDB_STATUS_TTL_DAYS=14

# ============================================
# Microsoft OAuth 2.0 (SMTP Client & PTC 組織網域郵件發送)
# ============================================
MICROSOFT_TENANT_ID=your-tenant-id
MICROSOFT_CLIENT_ID=your-client-id
MICROSOFT_CLIENT_SECRET=your-client-secret

# ============================================
# SendGrid (非組織網域郵件發送)
# ============================================
SENDGRID_API_KEY=your-sendgrid-api-key
ORG_EMAIL_DOMAIN=@ptc-nec.com.tw

# ============================================
# Attachment Volume (外接硬碟路徑)
# ============================================
ATTACHMENT_VOLUME_PATH=/data/mail-proxy/attachments
MAX_ATTACHMENT_SIZE_MB=25

# ============================================
# Worker
# 生產環境建議提高並發數
# ============================================
WORKER_CONCURRENCY=20
WORKER_PREFETCH=20
MAX_RETRY_COUNT=5

# ============================================
# JWT
# 生產環境務必使用安全的密鑰
# ============================================
JWT_SECRET=your-production-jwt-secret-key-must-be-secure

# ============================================
# Encryption (AES-256-GCM)
# 用於加密資料庫中的 Microsoft OAuth Client Secret
# 必須是 32 bytes 的隨機字串
# 產生方式: openssl rand -base64 32 | head -c 32
# ============================================
ENCRYPTION_KEY=your-32-bytes-encryption-key-here

# ============================================
# Admin Token 初始化設定
# ============================================
INIT_ADMIN_TOKEN=true
ADMIN_TOKEN_NAME=MIS Admin

# ============================================
# SMTP Inbound Server 設定
# 生產環境建議啟用 TLS 和認證
# ============================================
SMTP_INBOUND_PORT=25
SMTP_INBOUND_TLS_PORT=587
# 生產環境建議啟用 TLS
SMTP_TLS_ENABLED=true
# 生產環境建議啟用認證
SMTP_AUTH_REQUIRED=true
# 允許的寄件網域（生產環境建議限制）
SMTP_ALLOWED_DOMAINS=@ptc-nec.com.tw
SMTP_MAX_MESSAGE_SIZE_MB=25
